# 0521

상위 회의: 5월 (5%E1%84%8B%E1%85%AF%E1%86%AF%20165e6d39028a4ac49db3079ac9ca14c8.md)

리모컨

## Python 바인딩 시도 1

1. **파일 생성 (/home/tech-pioneers/.lircrc)**
    
    ```
     begin
     prog = rc
     button = KEY_0
     config = 0000
     end
    
     begin
     prog = rc
     button = KEY_1
     config = 1111
     end
    
     begin
     prog = rc
     button = KEY_2
     config = 2222
     end
    
    ```
    
2. **LIRC 시작**
    
    `sudo systemctl stop lircd` 혹은 `sudo /etc/init.d/lircd start`
    
3. **테스트 코드**
    
    ```python
     import lirc
     import time
    
     sockid = lirc.init( "rc", blocking=False)
    
     try:
     while True:
     button = lirc.nextcode()
     if button != []:
     print( button )
     time.sleep( 0.2 )
     except KeyboardInterrupt:
     lirc.deinit()
    
    ```
    
4. **에러 발생**
    
    Traceback (most recent call last):
    
    File "", line 1, in
    
    AttributeError: module 'lirc' has no attribute 'init'
    
5. **문제 상황: lirc 라이브러리**
    
    ```
       >>> import lirc
       >>> dir(lirc)
       ['Client', 'LircdConnection', '__all__', '__builtins__', '__cached__', '__doc__', '__file__', '__loader__', '__name__', '__package__', '__path__', '__spec__', '__version__', 'client', 'connection', 'exceptions', 'reply_packet_parser']
       >>> clinet = lirc.Client()
       >>> dir(clinet)
       ['__class__', '__delattr__', '__dict__', '__dir__', '__doc__', '__eq__', '__format__', '__ge__', '__getattribute__', '__getstate__', '__gt__', '__hash__', '__init__', '__init_subclass__', '__le__', '__lt__', '__module__', '__ne__', '__new__', '__reduce__', '__reduce_ex__', '__repr__', '__setattr__', '__sizeof__', '__str__', '__subclasshook__', '__weakref__', '_connection', '_last_send_start_key', '_last_send_start_remote', '_send_command', 'close', 'driver_option', 'list_remote_keys', 'list_remotes', 'send_once', 'send_start', 'send_stop', 'set_transmitters', 'simulate', 'start_logging', 'stop_logging', 'version']
    
    ```
    
6. **python-lirc를 사용하기 위한 시도 1**
    
    [python3-lirc_1.2.1-1_armhf.deb](https://github.com/tompreston/python-lirc/releases/download/v1.2.1/python3-lirc_1.2.1-1_armhf.deb) 를 다운받고 `sudo dpkg -i python3-lirc_1.2.1-1_armhf.deb` 실행
    
    결과: 같은 에러 발생
    
7. **cthyon 설치**

     ***`sudo apt***-***get install*** cython3` 설치

결과: 같은 에러 발생

1. **python-lirc를 사용하기 위한 시도 2**
    
    `git clone [https://github.com/tompreston/python-lirc.git](https://github.com/tompreston/python-lirc.git)`
    `cd python-lirc/`
    `make py3 && sudo python3 [setup.py](http://setup.py/) install`
    결과: 에러 발생으로 설치되지 않음
    
2. **evdev 사용 시도 에러**
    
    tech-pioneers@raspberrypi:~ $ `sudo apt-get install evtest`
    Reading package lists... Done
    Building dependency tree... Done
    Reading state information... Done
    You might want to run 'apt --fix-broken install' to correct these.
    The following packages have unmet dependencies:
    python-lirc : Depends: python (>= 2.7) but it is not installable
    Depends: python (< 2.8) but it is not installable
    E: Unmet dependencies. Try 'apt --fix-broken install' with no packages (or specify a solution).
    

1. **자료**
- lircd 설명 사이트: [https://www.lirc.org/html/lircd.html](https://www.lirc.org/html/lircd.html)
- Pi에서 여러 방식으로 LIRC 파이썬 바인딩 시도한 사이트: [https://www.sigmdel.ca/michel/ha/opi/ir_02_en.html](https://www.sigmdel.ca/michel/ha/opi/ir_02_en.html)
- LIRC Python Package 설명 사이트 : [https://lirc.readthedocs.io/en/latest/usage.html](https://lirc.readthedocs.io/en/latest/usage.html)
- evdev 사용 예제: [https://ignorantofthings.com/receiving-infrared-on-the-raspberry-pi-with-python/](https://ignorantofthings.com/receiving-infrared-on-the-raspberry-pi-with-python/)

## Python 시도 2

**1. 컨셉**

subprocess 모듈을 사용하여 irw 명령을 호출하고, 이를 통해 리모컨 신호를 읽는 방법

**2. 테스트 코드**

```python
import subprocess
# irw 명령을 subprocess로 실행
proc = subprocess.Popen(['irw'], stdout=subprocess.PIPE, stderr=subprocess.PIPE)

try:
    while True:
        # 리모컨 신호 수신
        line = proc.stdout.readline()
        if line:
            # 수신된 신호 출력
            print("Received line:", line.decode('utf-8').strip())
except KeyboardInterrupt:
    print("Exiting...")
finally:
    # 프로세스 종료
    proc.terminate()
    proc.wait()

```

**3. 결과**: 리모컨 신호는 받을 수 있으나 추가 프로세스 오버헤드가 있다.

    `tech-pioneers@raspberrypi:~ $ python3 test_remote.py
    Received line: 0000000000ffa25d 00 KEY_0 TECH-PIONEERS
    Received line: 0000000000ff629d 00 KEY_1 TECH-PIONEERS
    Received line: 0000000000ffe21d 00 KEY_2 TECH-PIONEERS`