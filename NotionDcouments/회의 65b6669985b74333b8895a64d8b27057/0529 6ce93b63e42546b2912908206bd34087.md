# 0529

상위 회의: 5월 (5%E1%84%8B%E1%85%AF%E1%86%AF%20165e6d39028a4ac49db3079ac9ca14c8.md)

1. ⭐time.sleep main process 중단되는 문제⭐ 
    
    딜레이 발생 문제가 ir 카메라의 컨디션 문제
    
    - 실행 코드를 바꾸지 않고 그대로 test_final_code.py 코드 썼는데 딜레이 없었다
    
    → 아두이노 delay 100 → 150으로 설정함. 300으로 두니 너무 받아오는 값이 느려져 문제
    
    추가로 아두이노 관련 설정해서 컨디션 문제 최소화 하기
    

1. 우선순위 섞인 문제 있었음. head 정렬 문제 → 추가 플래그 작성

```python
# if (utils.골과공정렬(goal_y - start_y, (int((output[0])//4 * 0.42)+int((output[2])//4 * 0.42))//2) == 2 or utils.골과공정렬(goal_y - start_y, (int((output[0])//4 * 0.42)+int((output[1])//4 * 0.42))//2) == 3) and tts_flag.value >= const.head_center_down:
                        #     if utils.골과공정렬(goal_y - start_y, (int((output[0])//4 * 0.42)+int((output[2])//4 * 0.42))//2) == 2:
                        #         tts_flag.value = const.head_center_up
                        #     elif utils.골과공정렬(goal_y - start_y, (int((output[0])//4 * 0.42)+int((output[2])//4 * 0.42))//2) == 3:
                        #         tts_flag.value = const.head_center_down
                        # elif utils.골과공정렬(goal_y - start_y,(int((output[0])//4 * 0.42)+int((output[2])//4 * 0.42))//2) and tts_flag.value != const.default:
                        #     tts_flag.value = const.default
                            
```

이 부분의 문제가 아님. 위 코드에서는 값을 제대로 바꾼다.

위치는 모르겠지만 어디선가 계속 999로 바꾼다…. 5, 6 바뀐 값 → 999로 덮어씌운다.

ball_missing일 때는 1이 뜨지만, 1보다 커지는 순간에는 2, 999, 2, 999 ,,,처럼 999와 섞여서 출력됨 → 왜 2, 3,,,만 나오지 않고 999 섞여 나오는지…? 확인필요

근데 소리 알림은 ball_missing, head_align 등등에 맞게 알림이 나오는 걸 보면 이 부분은 문제 없는 것일지도..

- head_missing(4)
head_center_up(5)
    
    위의 flag일 때 tts_flag가 계속 999로 덮여지고 있다.
    

```python
                # if len(output1) < 3 and tts_flag.value > const.head_align:
                #     tts_flag.value = const.head_align
                # elif len(output1) == 4 and tts_flag.value >= const.head_align:
                #     tts_flag.value = utils.test_head_align(output1)
                #     if tts_flag.value == const.default:
                #         align_success.value = const.align_default

```

head align 확인하는 이 부분 코드 문제인 것 같기는 한데 

- tts_flag.value > const.head_align
    - default(999)
        
        상황에서 head_align(7)로 바꿈
        
- tts_flag.value >= const.head_align
    - head_align(7)
    - default(999)
        
        상황에서 
        
        정렬 안되면 head_align(7)로 바꿈
        
        정렬되면 default(999)로 바꿈
        
- head_missing(4)
head_center_up(5)
    
    위의 flag이면 애초에 위의 조건문에 들어갈 수 없다. 그런데 계속 tts_flag가 999로 바뀌고 있는 상황이다.
    

1. 헤드 기울기 상황별 비프음 
- 방향에 따라 비프음 음낮이를 다르게해서 왼쪽으로 기울어진 경우 높은음, 오른쪽은 낮은음이 제공 되도록
- 밑의 코드를 활용 (utils.py)

```python
    # 정렬 및 기울어짐 판별
    if distance > -30 and distance < 30:
        return const.default
    elif distance < -30:
        print("CW")
        return const.head_align
    elif distance > 30:
        print("CCW")
        return const.head_align
    else:
        return const.head_align
```

1. 공 위치가 헤드 범위 밖에 있을 경우도 알림을 줘야함
- 값 조정 필요
- 밑의 코드를 활용하면 될 듯

```python
# 원이 범위를 벗어나면 경고 문구 출력하는 함수
def ballOutOfRangeAlert(x, radius, SCREEN_WIDTH, SCREEN_HEIGHT):
    if x - r < (SCREEN_WIDTH // 5) * 2 # 카메라쪽
        print("Circle x is going out of screen boundary!")
        return True
    elif x + r > (SCREEN_WIDTH // 5) * 3 # 바깥쪽
        print("Circle x is going out of screen boundary!")
        return True    
    else:
		    return False
```