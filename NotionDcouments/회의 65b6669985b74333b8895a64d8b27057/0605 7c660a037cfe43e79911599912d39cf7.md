# 0605

상위 회의: 6월 (6%E1%84%8B%E1%85%AF%E1%86%AF%204d69b2b7be794120a3f326c2e843eca9.md)

진행 상황

1. 벽 맞는 케이스
- flag 넣고 확인했더니 벽 관련 예외 케이스가 해결되지 않았다. 현재는 벽 근처/그 외 범위 나눠서 판단하도록 코드 수정한 상태이다. 테스트 해보며 수정 필요하다.
- win인데 벽을 맞았다고 판단되는 경우가 많이 나타남 
이는 홀 위치 변경 후 해결 해야 할 것으로 보임
- **벽에 부딪히지 않았는데 벽에 부딪혔다고 판단하는 걸 해결해야함**

1. 홀 위치 변경 필요
- 골이 홀 끝 쪽에 가면 아예 공이 잡히지 않는 경우가 있다.
- 홀 위치 앞쪽으로 변경 및 x 값 수정 필요하다.

1. 벽에 부딪히지 않고, 홀을 타고 살짝 돌아서 들어가는 경우는 어떻게 판단할지 
- 현재는 `방향 바뀜`으로 뜨고 있다.

1. 예외 케이스 확인을 위해 이제 영상 찍어서 확인하면 좋을 것 같다.

---

- [x]  utils.goal을 utils.is_within_goal로 변경
    - [x]  win 상황인데 먼저 out of range 뜨고 lose 뜬다
- [x]  홀 위치 변경
- [ ]  벽 맞는 케이스 ✅ (예외 사항 발생 시 수정 필요)
    - 문제 상황:
        - **벽에 부딪히지 않았는데 벽에 부딪혔다고 판단하고 있음**
        - temp_return_ball_direction 함수 수정
        
        ```python
            if current_pos_y < right_wall_y + wall_detect_threshold_y: # 공이 right 벽 근처에 있을 때 
                return 'rw'
            elif current_pos_y > left_wall_y - wall_detect_threshold_y:# 공이 left 벽 근처에 있을 때 
                return 'lw'
            else: 
                    # 그 외 범위: 공의 방향을 판단
                if abs(current_pos_y - previous_pos_y) >= threshold:
                    if previous_pos_y < current_pos_y:
                        return 'right'
                    elif previous_pos_y > current_pos_y:
                        return 'left'
                else:
                    return 'straight'
        ```
        
        - 벽 범위 설정해서 그 안에 들어오면 벽 맞음
        - 그 외 범위는 threshlod 5로 공의 방향 바뀌었는지 판단
        - 현재 벽에 부딪히지 않았는데 벽에 부딪혔다고 판단하는 경우는 해결
- [x]  헤드 기울기 소리 비프음 추가 및 변경
- [x]  끝 쪽 벽도 temp_return_ball_direction 함수에 추가
    - 공이 끝 벽에 맞고 홀로 들어오는 경우 Win이라고 뜨는 예외 케이스 해결을 위해
    - 끝 쪽 벽에 맞을 경우 `uw` return
    - temp_return_ball_direction 함수에 해당 부분 추가
    
    ```python
        elif previous_pos_x - back_threshold_x > current_pos_x: 
            return 'uw'
    ```
    

- [x]  check_movement argument에 prev_ball_position 전달
- [x]  check_movement 내부에 threshold 변수 이름 변경

- out of range
    - 터미널 상, out of range 일 때 shot flag는 True
    - 실제 결과가 out of range 일 때 (날려버렸을 때)
        - shot flag: 아예 shot flag가 True로 바뀌지 않고, 계속 False
        - isMoving:
        - 공이 밖으로 나간 경우 터미널 결과
            
            ```
            ech-pioneers@raspberrypi:~/capstone-project $ python3 opencv/final.py 
            pygame 2.1.2 (SDL 2.26.5, Python 3.11.2)
            Hello from the pygame community. https://www.pygame.org/contribute.html
            [2:30:28.325068710] [4880]  INFO Camera camera_manager.cpp:284 libcamera v0.2.0+120-eb00c13d
            [2:30:28.341856176] [4907]  INFO RPI pisp.cpp:695 libpisp version v1.0.5 999da5acb4f4 17-04-2024 (14:33:53)
            [2:30:28.363299771] [4907]  INFO RPI pisp.cpp:1154 Registered camera /base/axi/pcie@120000/rp1/i2c@80000/ov5647@36 to CFE device /dev/media2 and ISP device /dev/media1 using PiSP variant BCM2712_C0
            [2:30:28.371306044] [4880]  INFO Camera camera_manager.cpp:284 libcamera v0.2.0+120-eb00c13d
            [2:30:28.394388368] [4934]  INFO RPI pisp.cpp:695 libpisp version v1.0.5 999da5acb4f4 17-04-2024 (14:33:53)
            [2:30:28.422601679] [4934]  INFO RPI pisp.cpp:1154 Registered camera /base/axi/pcie@120000/rp1/i2c@80000/ov5647@36 to CFE device /dev/media2 and ISP device /dev/media1 using PiSP variant BCM2712_C0
            [2:30:28.428506642] [4880]  WARN V4L2 v4l2_pixelformat.cpp:344 Unsupported V4L2 pixel format RPBP
            [2:30:28.431546967] [4880]  INFO Camera camera.cpp:1183 configuring streams: (0) 640x480-RGB888 (1) 640x480-GBRG_PISP_COMP1
            [2:30:28.431798027] [4934]  INFO RPI pisp.cpp:1450 Sensor: /base/axi/pcie@120000/rp1/i2c@80000/ov5647@36 - Selected sensor format: 640x480-SGBRG10_1X10 - Selected CFE format: 640x480-PC1g
            shot_Flag False notmove True isMoving False
            QStandardPaths: wrong permissions on runtime directory /run/user/1000, 0770 instead of 0700
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            libpng warning: iCCP: known incorrect sRGB profile
            libpng warning: iCCP: known incorrect sRGB profile
            libpng warning: iCCP: known incorrect sRGB profile
            libpng warning: iCCP: known incorrect sRGB profile
            libpng warning: iCCP: known incorrect sRGB profile
            shot_Flag False notmove False isMoving True
            False True
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove False isMoving True
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove False isMoving True
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            諛⑺뼢 諛붾?lw
            shot_Flag False notmove False isMoving True
            shot_Flag False notmove False isMoving True
            True True
            shot_Flag True notmove True isMoving False
            諛⑺뼢 諛붾?rw
            諛⑺뼢 諛붾?rw
            out of range
            out of range
            out of range
            shot_Flag True notmove False isMoving True
            out of range
            out of range
            out of range
            out of range
            out of range
            out of range
            shot_Flag True notmove True isMoving False
            out of range
            out of range
            out of range
            out of range
            out of range
            out of range
            shot_Flag True notmove True isMoving False
            out of range
            out of range
            out of range
            out of range
            out of range
            out of range
            shot_Flag True notmove True isMoving False
            out of range
            out of range
            out of range
            out of range
            out of range
            out of range
            shot_Flag True notmove True isMoving False
            out of range
            out of range
            out of range
            out of range
            out of range
            shot_Flag True notmove True isMoving False
            out of range
            out of range
            out of range
            out of range
            out of range
            out of range
            shot_Flag True notmove True isMoving False
            out of range
            out of range
            out of range
            out of range
            out of range
            shot_Flag True notmove True isMoving False
            out of range
            out of range
            out of range
            out of range
            out of range
            out of range
            out of range
            shot_Flag True notmove True isMoving False
            out of range
            out of range
            out of range
            out of range
            out of range
            out of range
            shot_Flag True notmove True isMoving False
            out of range
            out of range
            out of range
            out of range
            out of range
            shot_Flag True notmove True isMoving False
            out of range
            out of range
            out of range
            out of range
            out of range
            out of range
            shot_Flag True notmove True isMoving False
            out of range
            out of range
            out of range
            out of range
            out of range
            out of range
            shot_Flag True notmove True isMoving False
            out of range
            out of range
            out of range
            out of range
            out of range
            out of range
            shot_Flag True notmove True isMoving False
            out of range
            out of range
            out of range
            out of range
            out of range
            shot_Flag True notmove True isMoving False
            out of range
            out of range
            out of range
            out of range
            out of range
            out of range
            shot_Flag True notmove True isMoving False
            out of range
            out of range
            out of range
            out of range
            out of range
            out of range
            shot_Flag True notmove True isMoving False
            out of range
            out of range
            out of range
            out of range
            out of range
            out of range
            shot_Flag True notmove True isMoving False
            out of range
            out of range
            out of range
            out of range
            out of range
            shot_Flag True notmove True isMoving False
            out of range
            out of range
            out of range
            out of range
            out of range
            out of range
            shot_Flag True notmove True isMoving False
            out of range
            out of range
            out of range
            out of range
            out of range
            out of range
            shot_Flag True notmove True isMoving False
            out of range
            out of range
            out of range
            out of range
            out of range
            shot_Flag True notmove True isMoving False
            out of range
            out of range
            out of range
            out of range
            out of range
            out of range
            shot_Flag True notmove True isMoving False
            out of range
            out of range
            out of range
            out of range
            out of range
            out of range
            shot_Flag True notmove True isMoving False
            out of range
            out of range
            out of range
            out of range
            out of range
            out of range
            shot_Flag True notmove True isMoving False
            out of range
            out of range
            out of range
            out of range
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove False isMoving True
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            qshot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            shot_Flag False notmove True isMoving False
            ^CProcess Process-2:
            Process Process-5:
            Traceback (most recent call last):
            Traceback (most recent call last):
              File "/usr/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
                self.run()
              File "/usr/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
                self.run()
              File "/usr/lib/python3.11/multiprocessing/process.py", line 108, in run
                self._target(*self._args, **self._kwargs)
              File "/usr/lib/python3.11/multiprocessing/process.py", line 108, in run
                self._target(*self._args, **self._kwargs)
              File "/home/tech-pioneers/capstone-project/opencv/final.py", line 53, in tts_process
                time.sleep(2)
              File "/home/tech-pioneers/capstone-project/opencv/final.py", line 326, in stream_opencv
                key = cv2.waitKey(1) & 0xFF
                      ^^^^^^^^^^^^^^
            KeyboardInterrupt
            KeyboardInterrupt
            Process Process-4:
            Traceback (most recent call last):
              File "/usr/lib/python3.11/multiprocessing/process.py", line 314, in _bootstrap
                self.run()
              File "/usr/lib/python3.11/multiprocessing/process.py", line 108, in run
                self._target(*self._args, **self._kwargs)
              File "/home/tech-pioneers/capstone-project/opencv/final.py", line 361, in check_movement
                time.sleep(0.3)
            KeyboardInterrupt
            Process Process-3:
            Traceback (most recent call last):
              File "/home/tech-pioneers/capstone-project/opencv/final.py", line 430, in <module>
                p1.join()
              File "/usr/lib/python3.11/multiprocessing/process.py", line 149, in join
                res = self._popen.wait(timeout)
                      ^^^^^^^^^^^^^^^^^^^^^^^^^
              File "/usr/lib/python3.11/multiprocessing/popen_fork.py", line 43, in wait
                return self.poll(os.WNOHANG if timeout == 0.0 else 0)
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
              File "/usr/lib/python3.11/multiprocessing/popen_fork.py", line 27, in poll
                pid, sts = os.waitpid(self.pid, flag)
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^
            KeyboardInterrupt
            Traceback (most recent call last):
            ```
            
        
        ⇒ isMoving이 True로 바뀔 때가 가끔 있으나, 거의 False로 출력
        
        - ㄴ 이거 isMoving 값 print 부탁요 checkt_movment 마지막에 주석처리된거 풀어서 확인 ⇒ isMoving이 true에서 false로 바뀌는게 중요함

---

---

예외 case

- 공을 세게 쳐서 아예 공이 밖으로 나간 경우 shot True가 되지 않음 
⇒ 그냥 너무 세게 치면 공의 형태가 무너져서 카메라가 잡지 못함 공 인식을 못하는 문제였음. 해결법x 카메라를 global shutter로 바꿔야함
    - isMoving 로직 → prev : 공의 위치 저장 0.3 초 뒤 cur: 현재 공의 위치 저장
    shot 로직 → isMoving이 true 였다가 false 로 변경 시 shot true
    이때 공의 위치는 stream_opencv에서 글로벌로 저장을 하는데 len(cnt) ≤ 0 즉 공이 없을 때는 공의 글로벌 위치를 변경하고 있지 않음 따라서 isMoving에서 마지막으로 공을 포착한 좌표를 가지고 isMoving을 판단하기 때문에 isMoving이 false로 안바뀌는가?.
    공이 포착이 안되는 경우 글로벌 공의 좌표를 특정한 값을 바꾸어 장외가 된 경우 isMoving 값이 false가 되도록 한다?
    ⇒ 의문 그렇다면 어차피 공이 밖으로 나가면 prev와 0.3초 뒤 cur 값이 같아서 isMoving이 false가 되는데..  ⇒ is_ball_out == 2 에 걸리지 않는가? 
    
    ⇒ 코드 상 그것과 상관없이 shot true가 되어야할 것 같은데

[KakaoTalk_20240605_185543564.mp4](0605%207c660a037cfe43e79911599912d39cf7/KakaoTalk_20240605_185543564.mp4)

동영상에서 발생한 예외 케이스

- 벽에 부딪히고 홀 뒤쪽으로 빠졌을 때, TTS가 ball hit the wall 가 아니라 out of range라고 뜨는 경우 → 우연히 카메라가 안 잡히는 곳에 공이 위치하면 out of range가 뜨고, 홀을 넘어섰지만 out of range 범위보다 더 앞일 경우는 ball hit the wall이 뜨는 것 같다… 하드웨어적으로 해결..?
    - 홀 컵 바로 뒷부분 벽을 세워서 홀을 넘어가는 케이스 제한하는 방법..
    - tts Process에서 out of range보다 ball hit if문을 앞으로 뺴면 ball hit을 우선으로 판단하지 않을까 이미 그렇게 되어있다면 ball hit flag가 먹히지않은것
    - 가장 쉬운건 ball hit the wall, out of range tts에서 구분 안하고 걍 lose 해버리기…^^
- 결과가 3초 뒤에 출력되지 않고, 밀려서 10초 뒤에 출력 되는 경우
- ~~벽에 부딪히고 홀 뒤쪽으로 빠졌을 때, lose가 뜨는 경우~~
    - ~~TTS 거리가 마이너스로 출력됨~~

넘어가는 경우 lose라고 판단 시

- 넘어가서 y축 벽에 맞는 경우 →
- HW

560

15

575 

### 금요일 날 할 일

- [ ]  매트, 카메라 설치 위치 정확하게 도면
- [ ]  퍼팅 서포터 설명을 어떻게 할 건지…오디오북
- [ ]  올바른 골프 퍼팅 자세 숙지하기